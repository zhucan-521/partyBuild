<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yizheng.partybuilding.repository.TabPbDeptSecretaryMapper">
  <resultMap id="BaseResultMap" type="com.yizheng.partybuilding.entity.TabPbDeptSecretary">
    <id column="secretary_id" jdbcType="BIGINT" property="secretaryId" />
    <result column="user_id" jdbcType="BIGINT" property="userId" />
    <result column="postive" jdbcType="VARCHAR" property="postive" />
    <result column="join_worker_time" jdbcType="TIMESTAMP" property="joinWorkerTime" />
    <result column="birth_address" jdbcType="VARCHAR" property="birthAddress" />
    <result column="professional_titles" jdbcType="VARCHAR" property="professionalTitles" />
    <result column="professional_specialty" jdbcType="VARCHAR" property="professionalSpecialty" />
    <result column="health" jdbcType="VARCHAR" property="health" />
    <result column="full_time_schooling" jdbcType="VARCHAR" property="fullTimeSchooling" />
    <result column="education" jdbcType="VARCHAR" property="education" />
    <result column="college_major" jdbcType="VARCHAR" property="collegeMajor" />
    <result column="college_major_two" jdbcType="VARCHAR" property="collegeMajorTwo" />
    <result column="serving_time" jdbcType="TIMESTAMP" property="servingTime" />
    <result column="serving_real_time" jdbcType="TIMESTAMP" property="servingRealTime" />
    <result column="incumbent_time" jdbcType="TIMESTAMP" property="incumbentTime" />
    <result column="incumbent_real_time" jdbcType="TIMESTAMP" property="incumbentRealTime" />
    <result column="assessment_situation" jdbcType="VARCHAR" property="assessmentSituation" />
    <result column="selection_situation" jdbcType="VARCHAR" property="selectionSituation" />
    <result column="promotion_situation" jdbcType="VARCHAR" property="promotionSituation" />
    <result column="army_cadres_situation" jdbcType="VARCHAR" property="armyCadresSituation" />
    <result column="reserve_cadres_situation" jdbcType="VARCHAR" property="reserveCadresSituation" />
    <result column="committee_duties" jdbcType="VARCHAR" property="committeeDuties" />
    <result column="order_num" jdbcType="BIGINT" property="orderNum" />
    <result column="del_flag" jdbcType="VARCHAR" property="delFlag" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="create_userid" jdbcType="BIGINT" property="createUserid" />
    <result column="create_username" jdbcType="VARCHAR" property="createUsername" />
    <result column="update_time" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="update_userid" jdbcType="BIGINT" property="updateUserid" />
    <result column="update_username" jdbcType="VARCHAR" property="updateUsername" />
    <result column="resume" jdbcType="LONGVARCHAR" property="resume" />
    <result column="training_situation" jdbcType="LONGVARCHAR" property="trainingSituation" />
    <result column="name" property="name"/>
    <collection property="user" ofType="com.yizheng.partybuilding.system.entity.SysUser">
      <id column="user_id" jdbcType="BIGINT" property="userId"/>
      <result column="dept_id" jdbcType="BIGINT" property="deptId"/>
      <result column="realname" jdbcType="VARCHAR" property="realname"/>
      <result column="identity_type" jdbcType="BIGINT" property="identityType"/>
      <result column="salt" jdbcType="VARCHAR" property="salt"/>
      <result column="avatar" jdbcType="VARCHAR" property="avatar"/>
      <result column="id_card_no" jdbcType="VARCHAR" property="idCardNo"/>
      <result column="used_name" jdbcType="VARCHAR" property="usedName"/>
      <result column="gender" jdbcType="BIGINT" property="gender"/>
      <result column="nation" jdbcType="BIGINT" property="nation"/>
      <result column="registeredresidence" jdbcType="VARCHAR" property="registeredresidence"/>
      <result column="ancestor_place" jdbcType="BIGINT" property="ancestorPlace"/>
      <result column="born_place" jdbcType="VARCHAR" property="bornPlace"/>
      <result column="health" jdbcType="BIGINT" property="health"/>
      <result column="familyorigin" jdbcType="BIGINT" property="familyorigin"/>
      <result column="birthday" jdbcType="TIMESTAMP" property="birthday"/>
      <result column="marital_status" jdbcType="BIGINT" property="maritalStatus"/>
      <result column="unit_id" jdbcType="BIGINT" property="unitId"/>
      <result column="unit_name" jdbcType="VARCHAR" property="unitName"/>
      <result column="work_date" jdbcType="TIMESTAMP" property="workDate"/>
      <result column="phone" jdbcType="VARCHAR" property="phone"/>
      <result column="fix_phone" jdbcType="VARCHAR" property="fixPhone"/>
      <result column="education" jdbcType="BIGINT" property="education"/>
      <result column="degree" jdbcType="BIGINT" property="degree"/>
      <result column="family_address" jdbcType="VARCHAR" property="familyAddress"/>
      <result column="community_addr" jdbcType="BIGINT" property="communityAddr"/>
      <result column="profession" jdbcType="BIGINT" property="profession"/>
      <result column="positive" jdbcType="BIGINT" property="positive"/>
      <result column="democratic_party" jdbcType="BIGINT" property="democraticParty"/>
      <result column="technician" jdbcType="BIGINT" property="technician"/>
      <result column="migrant" jdbcType="VARCHAR" property="migrant"/>
      <result column="graduated_from" jdbcType="VARCHAR" property="graduatedFrom"/>
      <result column="contact" jdbcType="BIGINT" property="contact"/>
      <result column="joinelsetime" jdbcType="TIMESTAMP" property="joinelsetime"/>
      <result column="police_office" jdbcType="VARCHAR" property="policeOffice"/>
      <result column="retired_time" jdbcType="TIMESTAMP" property="retiredTime"/>
      <result column="post_time" jdbcType="TIMESTAMP" property="postTime"/>
      <result column="portrait" jdbcType="VARCHAR" property="portrait"/>
      <result column="person_identity" jdbcType="BIGINT" property="personIdentity"/>
      <result column="stratum" jdbcType="BIGINT" property="stratum"/>
      <result column="front_line" jdbcType="BIGINT" property="frontLine"/>
      <result column="qq_number" jdbcType="VARCHAR" property="qqNumber"/>
      <result column="email" jdbcType="VARCHAR" property="email"/>
      <result column="wx_openid" jdbcType="VARCHAR" property="wxOpenid"/>
      <result column="qq_openid" jdbcType="VARCHAR" property="qqOpenid"/>
      <result column="pm_code" jdbcType="VARCHAR" property="pmCode"/>
      <result column="join_time" jdbcType="TIMESTAMP" property="joinTime"/>
      <result column="regular_time" jdbcType="TIMESTAMP" property="regularTime"/>
      <result column="regular_status" jdbcType="BIGINT" property="regularStatus"/>
      <result column="develop_type" jdbcType="BIGINT" property="developType"/>
      <result column="reference" jdbcType="VARCHAR" property="reference"/>
      <result column="fee_ratio" jdbcType="DECIMAL" property="feeRatio"/>
      <result column="join_after_august" jdbcType="TINYINT" property="joinAfterAugust"/>
      <result column="is_poor" jdbcType="TINYINT" property="isPoor"/>
      <result column="is_llost" jdbcType="TINYINT" property="isLlost"/>
      <result column="policy_face" jdbcType="BIGINT" property="policyFace"/>
      <result column="join_time2" jdbcType="TIMESTAMP" property="joinTime2"/>
      <result column="positived" jdbcType="VARCHAR" property="positived"/>
      <result column="join_contact_id" jdbcType="BIGINT" property="joinContactId"/>
      <result column="contactor" jdbcType="VARCHAR" property="contactor"/>
      <result column="app_date" jdbcType="TIMESTAMP" property="appDate"/>
      <result column="exp_activist_date" jdbcType="TIMESTAMP" property="expActivistDate"/>
      <result column="activist_date" jdbcType="TIMESTAMP" property="activistDate"/>
      <result column="exp_dev_date" jdbcType="TIMESTAMP" property="expDevDate"/>
      <result column="dev_date" jdbcType="TIMESTAMP" property="devDate"/>
      <result column="dev_stage" jdbcType="BIGINT" property="devStage"/>
      <result column="post_reason" jdbcType="LONGVARCHAR" property="postReason"/>
      <result column="work_resumes" jdbcType="LONGVARCHAR" property="workResumes"/>
      <result column="comment" jdbcType="LONGVARCHAR" property="comment"/>
      <result column="content" jdbcType="LONGVARCHAR" property="content"/>
      <result column="rewards" jdbcType="LONGVARCHAR" property="rewards"/>
      <result column="present_perform" jdbcType="LONGVARCHAR" property="presentPerform"/>
      <result column="registry_status" jdbcType="BIGINT" property="registryStatus"/>
      <result column="join_org_phone" jdbcType="VARCHAR" property="joinOrgPhone"/>
      <result column="is_self_dev" jdbcType="TINYINT" property="isSelfDev"/>
      <result column="is_taiwaner" jdbcType="TINYINT" property="isTaiwaner"/>
      <result column="job_position" jdbcType="VARCHAR" property="jobPosition"/>
    </collection>
  </resultMap>
  <sql id="Base_Column_List">
    secretary_id, postive, join_worker_time, birth_address, professional_titles,
    professional_specialty, health, full_time_schooling, education, college_major, college_major_two, 
    serving_time, serving_real_time, incumbent_time, incumbent_real_time, assessment_situation, 
    selection_situation, promotion_situation, army_cadres_situation, reserve_cadres_situation, 
    committee_duties, order_num,resume, training_situation
  </sql>

  <select id="selectList" parameterType="com.yizheng.partybuilding.entity.TabPbDeptSecretary" resultMap="BaseResultMap">
      SELECT secretary.*,`user`.*,dept.name FROM tab_pb_dept_secretary secretary
      JOIN sys_user `user` ON secretary.user_id = `user`.user_id AND `user`.del_flag = 0
      join sys_dept dept on `user`.dept_id = dept.dept_id and dept.del_flag = '0'
      WHERE secretary.del_flag = 0
      <if test="idCardNo != null">
        and `user`.id_card_no = #{idCardNo}
      </if>
      <if test="realname != null">
      and `user`.realname LIKE CONCAT('%',#{realname},'%')
      </if>
      <if test="orgRange != null and orgRange != ''">
      <choose>
        <when test="orgRange == 1">
          AND (dept.dept_id = #{rangeDeptId} OR dept.parent_id = #{rangeDeptId})
        </when>
        <when test="orgRange == 2">
          AND find_in_set(#{rangeDeptId}, dept.full_path)
        </when>
      </choose>
      </if>
      <if test="rangeDeptId == null or orgRange.toString() == ''">
          AND dept.dept_id = #{rangeDeptId}
      </if>
  </select>

  <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
    SELECT secretary.*,`user`.* FROM tab_pb_dept_secretary secretary
    JOIN sys_user `user` ON secretary.user_id = `user`.user_id AND `user`.del_flag = 0
    WHERE secretary.del_flag = 0 and secretary_id = #{secretaryId,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    delete from tab_pb_dept_secretary
    where secretary_id = #{secretaryId,jdbcType=BIGINT}
  </delete>
  <insert id="insertSelective" parameterType="com.yizheng.partybuilding.entity.TabPbDeptSecretary">
    insert into tab_pb_dept_secretary
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="userId != null">
        user_id,
      </if>
      <if test="postive != null">
        postive,
      </if>
      <if test="joinWorkerTime != null">
        join_worker_time,
      </if>
      <if test="birthAddress != null">
        birth_address,
      </if>
      <if test="professionalTitles != null">
        professional_titles,
      </if>
      <if test="professionalSpecialty != null">
        professional_specialty,
      </if>
      <if test="health != null">
        health,
      </if>
      <if test="fullTimeSchooling != null">
        full_time_schooling,
      </if>
      <if test="education != null">
        education,
      </if>
      <if test="collegeMajor != null">
        college_major,
      </if>
      <if test="collegeMajorTwo != null">
        college_major_two,
      </if>
      <if test="servingTime != null">
        serving_time,
      </if>
      <if test="servingRealTime != null">
        serving_real_time,
      </if>
      <if test="incumbentTime != null">
        incumbent_time,
      </if>
      <if test="incumbentRealTime != null">
        incumbent_real_time,
      </if>
      <if test="assessmentSituation != null">
        assessment_situation,
      </if>
      <if test="selectionSituation != null">
        selection_situation,
      </if>
      <if test="promotionSituation != null">
        promotion_situation,
      </if>
      <if test="armyCadresSituation != null">
        army_cadres_situation,
      </if>
      <if test="reserveCadresSituation != null">
        reserve_cadres_situation,
      </if>
      <if test="committeeDuties != null">
        committee_duties,
      </if>
      <if test="orderNum != null">
        order_num,
      </if>
      <if test="delFlag != null">
        del_flag,
      </if>
      <if test="createTime != null">
        create_time,
      </if>
      <if test="createUserid != null">
        create_userid,
      </if>
      <if test="createUsername != null">
        create_username,
      </if>
      <if test="updateTime != null">
        update_time,
      </if>
      <if test="updateUserid != null">
        update_userid,
      </if>
      <if test="updateUsername != null">
        update_username,
      </if>
      <if test="resume != null">
        resume,
      </if>
      <if test="trainingSituation != null">
        training_situation,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="userId != null">
        #{userId,jdbcType=BIGINT},
      </if>
      <if test="postive != null">
        #{postive,jdbcType=VARCHAR},
      </if>
      <if test="joinWorkerTime != null">
        #{joinWorkerTime,jdbcType=TIMESTAMP},
      </if>
      <if test="birthAddress != null">
        #{birthAddress,jdbcType=VARCHAR},
      </if>
      <if test="professionalTitles != null">
        #{professionalTitles,jdbcType=VARCHAR},
      </if>
      <if test="professionalSpecialty != null">
        #{professionalSpecialty,jdbcType=VARCHAR},
      </if>
      <if test="health != null">
        #{health,jdbcType=VARCHAR},
      </if>
      <if test="fullTimeSchooling != null">
        #{fullTimeSchooling,jdbcType=VARCHAR},
      </if>
      <if test="education != null">
        #{education,jdbcType=VARCHAR},
      </if>
      <if test="collegeMajor != null">
        #{collegeMajor,jdbcType=VARCHAR},
      </if>
      <if test="collegeMajorTwo != null">
        #{collegeMajorTwo,jdbcType=VARCHAR},
      </if>
      <if test="servingTime != null">
        #{servingTime,jdbcType=TIMESTAMP},
      </if>
      <if test="servingRealTime != null">
        #{servingRealTime,jdbcType=TIMESTAMP},
      </if>
      <if test="incumbentTime != null">
        #{incumbentTime,jdbcType=TIMESTAMP},
      </if>
      <if test="incumbentRealTime != null">
        #{incumbentRealTime,jdbcType=TIMESTAMP},
      </if>
      <if test="assessmentSituation != null">
        #{assessmentSituation,jdbcType=VARCHAR},
      </if>
      <if test="selectionSituation != null">
        #{selectionSituation,jdbcType=VARCHAR},
      </if>
      <if test="promotionSituation != null">
        #{promotionSituation,jdbcType=VARCHAR},
      </if>
      <if test="armyCadresSituation != null">
        #{armyCadresSituation,jdbcType=VARCHAR},
      </if>
      <if test="reserveCadresSituation != null">
        #{reserveCadresSituation,jdbcType=VARCHAR},
      </if>
      <if test="committeeDuties != null">
        #{committeeDuties,jdbcType=VARCHAR},
      </if>
      <if test="orderNum != null">
        #{orderNum,jdbcType=BIGINT},
      </if>
      <if test="delFlag != null">
        #{delFlag,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createUserid != null">
        #{createUserid,jdbcType=BIGINT},
      </if>
      <if test="createUsername != null">
        #{createUsername,jdbcType=VARCHAR},
      </if>
      <if test="updateTime != null">
        #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateUserid != null">
        #{updateUserid,jdbcType=BIGINT},
      </if>
      <if test="updateUsername != null">
        #{updateUsername,jdbcType=VARCHAR},
      </if>
      <if test="resume != null">
        #{resume,jdbcType=LONGVARCHAR},
      </if>
      <if test="trainingSituation != null">
        #{trainingSituation,jdbcType=LONGVARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.yizheng.partybuilding.entity.TabPbDeptSecretary">
    update tab_pb_dept_secretary
    <set>
      <if test="userId != null">
        user_id = #{userId,jdbcType=BIGINT},
      </if>
      <if test="postive != null">
        postive = #{postive,jdbcType=VARCHAR},
      </if>
      <if test="joinWorkerTime != null">
        join_worker_time = #{joinWorkerTime,jdbcType=TIMESTAMP},
      </if>
      <if test="birthAddress != null">
        birth_address = #{birthAddress,jdbcType=VARCHAR},
      </if>
      <if test="professionalTitles != null">
        professional_titles = #{professionalTitles,jdbcType=VARCHAR},
      </if>
      <if test="professionalSpecialty != null">
        professional_specialty = #{professionalSpecialty,jdbcType=VARCHAR},
      </if>
      <if test="health != null">
        health = #{health,jdbcType=VARCHAR},
      </if>
      <if test="fullTimeSchooling != null">
        full_time_schooling = #{fullTimeSchooling,jdbcType=VARCHAR},
      </if>
      <if test="education != null">
        education = #{education,jdbcType=VARCHAR},
      </if>
      <if test="collegeMajor != null">
        college_major = #{collegeMajor,jdbcType=VARCHAR},
      </if>
      <if test="collegeMajorTwo != null">
        college_major_two = #{collegeMajorTwo,jdbcType=VARCHAR},
      </if>
      <if test="servingTime != null">
        serving_time = #{servingTime,jdbcType=TIMESTAMP},
      </if>
      <if test="servingRealTime != null">
        serving_real_time = #{servingRealTime,jdbcType=TIMESTAMP},
      </if>
      <if test="incumbentTime != null">
        incumbent_time = #{incumbentTime,jdbcType=TIMESTAMP},
      </if>
      <if test="incumbentRealTime != null">
        incumbent_real_time = #{incumbentRealTime,jdbcType=TIMESTAMP},
      </if>
      <if test="assessmentSituation != null">
        assessment_situation = #{assessmentSituation,jdbcType=VARCHAR},
      </if>
      <if test="selectionSituation != null">
        selection_situation = #{selectionSituation,jdbcType=VARCHAR},
      </if>
      <if test="promotionSituation != null">
        promotion_situation = #{promotionSituation,jdbcType=VARCHAR},
      </if>
      <if test="armyCadresSituation != null">
        army_cadres_situation = #{armyCadresSituation,jdbcType=VARCHAR},
      </if>
      <if test="reserveCadresSituation != null">
        reserve_cadres_situation = #{reserveCadresSituation,jdbcType=VARCHAR},
      </if>
      <if test="committeeDuties != null">
        committee_duties = #{committeeDuties,jdbcType=VARCHAR},
      </if>
      <if test="orderNum != null">
        order_num = #{orderNum,jdbcType=BIGINT},
      </if>
      <if test="delFlag != null">
        del_flag = #{delFlag,jdbcType=VARCHAR},
      </if>
      <if test="createTime != null">
        create_time = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createUserid != null">
        create_userid = #{createUserid,jdbcType=BIGINT},
      </if>
      <if test="createUsername != null">
        create_username = #{createUsername,jdbcType=VARCHAR},
      </if>
      <if test="updateTime != null">
        update_time = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateUserid != null">
        update_userid = #{updateUserid,jdbcType=BIGINT},
      </if>
      <if test="updateUsername != null">
        update_username = #{updateUsername,jdbcType=VARCHAR},
      </if>
      <if test="resume != null">
        resume = #{resume,jdbcType=LONGVARCHAR},
      </if>
      <if test="trainingSituation != null">
        training_situation = #{trainingSituation,jdbcType=LONGVARCHAR},
      </if>
    </set>
    where secretary_id = #{secretaryId,jdbcType=BIGINT}
  </update>
  <update id="tombstone" parameterType="com.yizheng.partybuilding.entity.TabPbDeptSecretary">
    update tab_pb_dept_secretary
    <set>
      del_flag = 1,
      <if test="updateTime != null">
        update_time = #{updateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="updateUserid != null">
        update_userid = #{updateUserid,jdbcType=BIGINT},
      </if>
      <if test="updateUsername != null">
        update_username = #{updateUsername,jdbcType=VARCHAR},
      </if>
    </set>
    where secretary_id = #{secretaryId}
  </update>

  <select id="punishmentRewards" resultType="com.yizheng.partybuilding.dto.PunishmentRewardsDto" parameterType="java.lang.Long">
  SELECT * FROM(
  SELECT rewards_date AS startingTime,rewards_name AS `name` FROM tab_pb_rewards WHERE del_flag = 0 and user_id = #{userId}
  UNION
  SELECT punish_date AS startingTime,punish_name AS `name` FROM tab_pb_punishment WHERE del_flag = 0 and user_id = #{userId} ) a ORDER BY startingTime
  </select>
</mapper>